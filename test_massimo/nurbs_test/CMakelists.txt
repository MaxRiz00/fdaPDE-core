cmake_minimum_required(VERSION 3.14)

# Project name
project(TEST)

# Set C++ standard to C++20
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Enable warnings and optimizations
set(CMAKE_EXPORT_COMPILE_COMMANDS ON)
set(CMAKE_WARNINGS_FLAGS "-Wall")
set(CMAKE_CXX_FLAGS "-g -O2 -std=c++20 -march=native ${CMAKE_WARNINGS_FLAGS}")

# enable testing functionality using gtest
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/609281088cfefc76f9d0ce82e1ff6c30cc3591e5.zip
)

# Find packages
find_package(Eigen3 3.4 REQUIRED NO_MODULE)
find_package(GTest REQUIRED)

# Include directories
include_directories(../../fdaPDE)
include_directories(${GTEST_INCLUDE_DIRS})

# Add the executable
add_executable(NurbsTest nurbs_test.cpp)

# Link libraries
target_link_libraries(NurbsTest Eigen3::Eigen GTest::GTest GTest::Main)

# Enable testing
enable_testing()
add_test(NAME NurbsTest COMMAND $<TARGET_FILE:NurbsTest>)
#set_tests_properties(NurbsTest PROPERTIES WORKING_DIRECTORY ${CMAKE_SOURCE_DIR})

include(GoogleTest)
gtest_discover_tests(NurbsTest)